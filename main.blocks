<xml xmlns="https://developers.google.com/blockly/xml"><variables><variable type="KIND_SpriteKind" id="!@w1XpGU)/Q(o}zQ[RyI">Cursor</variable><variable type="KIND_SpriteKind" id="=?aLL^C3{3$}dQZ#8oue">Player</variable><variable type="KIND_SpriteKind" id="}5J-JG$}n6]*86ZxDjqA">Projectile</variable><variable type="KIND_SpriteKind" id="$7`Wr-rWRGjX.W411lHb">Food</variable><variable type="KIND_SpriteKind" id="J2d%LH4|c-e^m5^X^k=j">Enemy</variable><variable id="o!b0[)4vmj|(?lp]ah:$">targetLocations</variable><variable id="3{I?dy@1-T|e2cS:1$@%">targetLocation</variable><variable id="(`^!!E4s||O8q4GJC]=~">myImage</variable><variable id="y-gBX=Xz9TWYE]eS3s5Q">ret</variable><variable id="H(RjK*qag5i|PIJ$o/xV">aliveSprites</variable><variable id="l@9$;fKjK#$.Iiy`DWSd">currentLocationData</variable><variable id="wC./_sqm1XgCyFj?BzgG">spriteId</variable><variable id="dvfky@^nl)M[VDEjFl/q">cursorSprite</variable><variable id="nElHPXdq7;P.Kg%gnA~Q">cursorLocation</variable><variable id="*S8+d$R~=IglB`vhy;6d">currentMoveDestinationShaders</variable><variable id=")Y07WePA:sx(]m!ey%8y">shader</variable><variable id="r+NrJ2q^#oXq3m(TzkH9">currentLoc</variable><variable id=";x$8kRIPQ9BEY(C~$Y2w">mySprite</variable><variable id="6v@RAuHnu@oQ7/Exe[*|">range</variable><variable id="OTJOOz=WV*6Hx`():EJY">minRow</variable><variable id="[l0A/k(I4|n^U5Yh}!!]">maxRow</variable><variable id="j^`#7uUp)cp-[Zk`1-c3">enemySprite</variable><variable id="Q)xbO!+^5,H0-*6Nl:54">playerSprite</variable></variables><block type="pxt-on-start" id="_tz?d6?a2u4NU|s%w#pk" x="20" y="20"><statement name="HANDLER"><block type="typescript_statement" id="$[D@6.^yJhkn(nPdsuAV" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let currentMoveDestinationShaders:Sprite[] = []" numlines="1" declaredvars="currentMoveDestinationShaders"></mutation><next><block type="typescript_statement" id="f!?SFYM*Cc5H|Z+tw|9E" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let currentLocationData: number[] = []" numlines="1" declaredvars="currentLocationData"></mutation><next><block type="typescript_statement" id="5ugI`Vj@.Q@V0l7KocC)" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let aliveSprites: SparseArray&lt;Sprite&gt; = {}" numlines="1" declaredvars="aliveSprites"></mutation><next><block type="typescript_statement" id="7zW.QX_d+y6mC?`MZD5c" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="function moveSprite(sprite:Sprite, fromLocation:tiles.Location, toLocation:tiles.Location) {" line1="    currentLocationData[fromLocation.col + fromLocation.row*game.currentScene().tileMap.data.width] = null" line2="    currentLocationData[toLocation.col + toLocation.row * game.currentScene().tileMap.data.width] = sprite.id" line3="}" numlines="4"></mutation><next><block type="typescript_statement" id="tX%rD[i}U``@D_)zMYLg" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="scene.setTileMapLevel(tilemap`default`)" numlines="1"></mutation><next><block type="controls_repeat_ext" id="$8~:jyOvy3B5#_hUG+@z"><value name="TIMES"><shadow type="math_whole_number" id=",a]*@b9J~:.A7.P.Mz`C"><field name="NUM">4</field></shadow></value><statement name="DO"><block type="variables_set" id="|TA`ei!GT,8AocKd5{7^"><field name="VAR" id="j^`#7uUp)cp-[Zk`1-c3">enemySprite</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="function_call_output" id="FGgd:_V[NDLg:p0156Ta"><mutation name="createAndRandonlyPlaceSprite" functionid="Q3JG[UZIk3XT)5k`C`H2"><arg name="spriteImage" id="r2h03aack4j4mcxikupnl" type="Image"></arg><arg name="spriteKind" id="9bryfc247b0o442dzy402p" type="number"></arg><arg name="targetTile" id="k3srtbrdz2b6r3koopj7" type="Image"></arg></mutation><value name="r2h03aack4j4mcxikupnl"><shadow type="variables_get"><field name="VAR" id="(`^!!E4s||O8q4GJC]=~">myImage</field></shadow><block type="screen_image_picker" id="Qs;9D/jc`PCstq8sGIEr"><field name="img">img`
. . . . . . f . . . f . . . . . 
. . . . . f 4 f . f 4 f . . . . 
. . . . f 4 5 4 f 4 5 4 f . . . 
. . f f 4 4 4 5 4 5 4 4 4 f . . 
. f 8 8 8 1 f 8 8 1 f 8 8 4 f . 
. 8 8 6 8 1 1 8 8 1 1 8 8 8 f . 
. f 6 6 4 4 4 5 f 5 4 4 4 4 f . 
. . f 4 4 4 2 4 4 4 2 4 4 4 f . 
. . . f 4 4 4 2 2 2 4 4 4 f . . 
. 8 . . f 4 4 4 4 4 4 f . 8 . . 
. 8 8 f 4 4 4 5 5 4 4 4 f 8 8 . 
. . 8 4 4 4 5 5 5 5 4 4 4 4 8 . 
. . . f 4 4 4 5 5 4 4 4 f f . . 
. . . f 4 4 4 4 4 4 4 4 f . . . 
. . . . f 4 4 f f 4 4 f . . . . 
. . . . . f f . . f f . . . . . 
`</field><data>{"commentRefs":[],"fieldData":{"img":null}}</data></block></value><value name="9bryfc247b0o442dzy402p"><shadow type="math_number"><field name="NUM">1</field></shadow><block type="spritekind" id="p;zhtLIJj2;a)Z$9?1jF"><field name="MEMBER">Enemy</field></block></value><value name="k3srtbrdz2b6r3koopj7"><shadow type="variables_get"><field name="VAR" id="(`^!!E4s||O8q4GJC]=~">myImage</field></shadow><block type="tileset_tile_picker" id="9.gkt8%9(2;mH?OQK%!!"><field name="tile">sprites.castle.tilePath5</field></block></value></block></value></block></statement><next><block type="variables_set" id="N?!Ynu)nbohUMwXqFe77"><field name="VAR" id="Q)xbO!+^5,H0-*6Nl:54">playerSprite</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="function_call_output" id="~b~Q4^LSv4EArJCX([cd"><mutation name="createAndPlaceSprite" functionid="L`JA0;.A;#,Int4g7u*h"><arg name="img" id="t9z1j85h32d2inf7cue" type="Image"></arg><arg name="spriteKind" id="4ss0q2by2ey6ivx4nzgfp" type="number"></arg><arg name="col" id="jvda6afl77fdajkbjx2mk" type="number"></arg><arg name="row" id="mqy7ud6p56gv15piemcs" type="number"></arg></mutation><value name="t9z1j85h32d2inf7cue"><shadow type="variables_get"><field name="VAR" id="(`^!!E4s||O8q4GJC]=~">myImage</field></shadow><block type="screen_image_picker" id="=g@Y|2KBRpcWf0|-Le/o"><field name="img">img`
. . . . . . 5 5 5 5 . . . . . . 
. . . . 5 5 5 5 5 5 5 5 . . . . 
. . . 5 5 5 5 5 5 5 5 5 5 . . . 
. . 5 5 5 5 5 2 2 5 5 5 5 5 . . 
. . 5 5 5 5 5 2 2 5 5 5 5 5 . . 
. . 5 5 5 5 5 5 5 5 5 5 5 5 . . 
. . 5 5 5 5 e e e e 5 5 5 5 . . 
. 5 5 e 5 b f 4 4 f b 5 e 5 5 . 
. 5 e e 8 1 f d d f 1 8 e e 5 . 
. . f e e d d d d d d e e f . . 
. . . f e e 8 8 8 8 e e f . . . 
. . e 8 f 8 8 5 5 8 8 f 8 e . . 
. . 8 d f 8 8 8 8 8 8 f d 8 . . 
. . 8 8 f 8 8 5 5 8 8 f 8 8 . . 
. . . . . f f f f f f . . . . . 
. . . . . 8 8 . . 8 8 . . . . . 
`</field><data>{"commentRefs":[],"fieldData":{"img":null}}</data></block></value><value name="4ss0q2by2ey6ivx4nzgfp"><shadow type="math_number"><field name="NUM">1</field></shadow><block type="spritekind" id="2clH]IL0li*/1*Od=K#K"><field name="MEMBER">Player</field></block></value><value name="jvda6afl77fdajkbjx2mk"><shadow type="math_number" id="S^SVg!b*ntON5}nOAOD`"><field name="NUM">1</field></shadow></value><value name="mqy7ud6p56gv15piemcs"><shadow type="math_number" id="0k[E=L3jCV2WDueu*z`c"><field name="NUM">1</field></shadow></value></block></value><next><block type="variables_set" id="UW4{?l,kKi@!GO8th(aS"><field name="VAR" id="dvfky@^nl)M[VDEjFl/q">cursorSprite</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="spritescreate" id="$S1+`PPSA*r6.+(XlK8;"><value name="img"><shadow type="screen_image_picker" id="RZ#6SRH1=_oIqIVZ+.o7"><field name="img">img`
. 2 2 2 2 2 2 2 2 2 2 2 2 2 2 . 
2 . . . . . . . . . . . . . . 2 
2 . . . . . . . . . . . . . . 2 
2 . . . . . . . . . . . . . . 2 
2 . . . . . . . . . . . . . . 2 
2 . . . . . . . . . . . . . . 2 
2 . . . . . . . . . . . . . . 2 
2 . . . . . . . . . . . . . . 2 
2 . . . . . . . . . . . . . . 2 
2 . . . . . . . . . . . . . . 2 
2 . . . . . . . . . . . . . . 2 
2 . . . . . . . . . . . . . . 2 
2 . . . . . . . . . . . . . . 2 
2 . . . . . . . . . . . . . . 2 
2 . . . . . . . . . . . . . . 2 
. 2 2 2 2 2 2 2 2 2 2 2 2 2 2 . 
`</field><data>{"commentRefs":[],"fieldData":{"img":null}}</data></shadow></value><value name="kind"><shadow type="spritekind" id="#jg#vbJ$#b[W{L#G@iem"><field name="MEMBER">Cursor</field></shadow></value></block></value><next><block type="mapplaceontile" id="O358gdf2T:}49uP@ee6G"><value name="sprite"><shadow type="variables_get" id="*1{4MC,8!+S(`.N5J.%#"><field name="VAR" id="dvfky@^nl)M[VDEjFl/q">cursorSprite</field></shadow></value><value name="loc"><shadow type="mapgettile" id="wKCq5Vmx$~yNC3;m5+@9"><value name="col"><shadow type="math_number" id="wL!?gS~K,8+L/E|.=}U4"><field name="NUM">0</field></shadow></value><value name="row"><shadow type="math_number" id="1.nrN)(hm/`J(v4HTHW`"><field name="NUM">0</field></shadow></value></shadow></value><next><block type="camerafollow" id="(597pX*bg7-F8Mc4a{i5"><value name="sprite"><shadow type="variables_get" id="rt|k2=[{p:saQCyYG|S["><field name="VAR" id="dvfky@^nl)M[VDEjFl/q">cursorSprite</field></shadow></value><next><block type="variables_set" id="H,_8e0~[uy1@cRNi*vSN"><field name="VAR" id="nElHPXdq7;P.Kg%gnA~Q">cursorLocation</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="lists_create_with" id="/_$ML?CX6ER[hz$ca2YI"><mutation items="2" horizontalafter="3"></mutation><value name="ADD0"><shadow type="math_number" id="zKUDPS[8MTgS#vGW3y{@"><field name="NUM">0</field></shadow></value><value name="ADD1"><shadow type="math_number" id="{y2p.I#eLgBED2P(WkPa"><field name="NUM">0</field></shadow></value></block></value><next><block type="function_call" id="|9!fhl_^BK!$4bJL]EkQ"><mutation name="applySelectionCursorMode" functionid="0Gmc)L+.4LKt3PIAiFTX"></mutation></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type="function_definition" id="Mn[k%{]H8;ziWEdR=)[G" x="1144" y="20"><mutation name="getSpriteLocation" functionid="%zG`%k*SZ8vSl%bT/TaI"><arg name="sprite" id="rbads6hlvipexvnvsx6fo" type="Sprite"></arg></mutation><field name="function_name">getSpriteLocation</field><value name="rbads6hlvipexvnvsx6fo"><shadow type="argument_reporter_custom" id="v,7G-TXma0G0LPxh]+.T"><mutation typename="Sprite"></mutation><field name="VALUE">sprite</field></shadow></value><statement name="STACK"><block type="function_return" id="YAhbLFZ}fc[rFgguMzs0"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="tilemap_locationOfSprite" id="nf2l}/Y|,EgW;nQ*Gs_m"><value name="s"><shadow type="variables_get"></shadow><block type="argument_reporter_custom" id="L:a1Fl=7O|V}QxU=.HZw"><mutation typename="Sprite"></mutation><field name="VALUE">sprite</field></block></value></block></value></block></statement></block><block type="function_definition" id="Z-)II9WS^)hb0ilRB|G+" x="1545" y="20"><mutation name="createAndRandonlyPlaceSprite" functionid="Q3JG[UZIk3XT)5k`C`H2"><arg name="spriteImage" id="r2h03aack4j4mcxikupnl" type="Image"></arg><arg name="spriteKind" id="9bryfc247b0o442dzy402p" type="number"></arg><arg name="targetTile" id="k3srtbrdz2b6r3koopj7" type="Image"></arg></mutation><field name="function_name">createAndRandonlyPlaceSprite</field><value name="r2h03aack4j4mcxikupnl"><shadow type="argument_reporter_custom" id="!7cc_3ZE@Z{1Fd4*=^)#"><mutation typename="Image"></mutation><field name="VALUE">spriteImage</field></shadow></value><value name="9bryfc247b0o442dzy402p"><shadow type="argument_reporter_number" id="$lp,s:,e[^I#Xx3#JWqY"><field name="VALUE">spriteKind</field></shadow></value><value name="k3srtbrdz2b6r3koopj7"><shadow type="argument_reporter_custom" id="ABxRv6r6+Aw;lDAzUf`q"><mutation typename="Image"></mutation><field name="VALUE">targetTile</field></shadow></value><statement name="STACK"><block type="variables_set" id="P5g{s6sD*sEjoR2#ffj+"><field name="VAR" id="o!b0[)4vmj|(?lp]ah:$">targetLocations</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="mapgettilestype" id=")J+OK8.Lt$jO~qxwlXYk"><value name="tile"><shadow type="tileset_tile_picker"></shadow><block type="argument_reporter_custom" id="$QyeTS=kI[U38}z^_1=:"><mutation typename="Image"></mutation><field name="VALUE">targetTile</field></block></value></block></value><next><block type="variables_set" id="mnYv*3A0J!$+0+i24m)f"><field name="VAR" id="3{I?dy@1-T|e2cS:1$@%">targetLocation</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="lists_index_get" id="Lu%Ciq=vW7-7I_i:7sVA"><value name="LIST"><block type="variables_get" id="+M|oRm!aA+H5*(R:L-_2"><field name="VAR" id="o!b0[)4vmj|(?lp]ah:$">targetLocations</field></block></value><value name="INDEX"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="device_random" id="UF~I;P==Gx3oGN;CTj6^"><value name="min"><shadow type="math_number" id="m6vW|bjFFw{q/kHp-k@n"><field name="NUM">0</field></shadow></value><value name="limit"><block type="math_arithmetic" id="ZBLm+nL5j)!!%J=/eQ2u"><field name="OP">MINUS</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="lists_length" id="$CoBI%NZKTu/pbS08$|Q"><value name="VALUE"><block type="variables_get" id="?7OPp8:_Ti?o+dEX+*,B"><field name="VAR" id="o!b0[)4vmj|(?lp]ah:$">targetLocations</field></block></value></block></value><value name="B"><shadow type="math_number" id="m,c;Plu4yegYI,*`]1.F"><field name="NUM">1</field></shadow></value></block></value></block></value></block></value><next><block type="function_return" id="jr8Hp3uqH87btO_e*0Ba"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="function_call_output" id="`M3q/mcCwCCaw?=.t1Ly"><mutation name="createAndPlaceSprite" functionid="L`JA0;.A;#,Int4g7u*h"><arg name="img" id="t9z1j85h32d2inf7cue" type="Image"></arg><arg name="spriteKind" id="4ss0q2by2ey6ivx4nzgfp" type="number"></arg><arg name="col" id="jvda6afl77fdajkbjx2mk" type="number"></arg><arg name="row" id="mqy7ud6p56gv15piemcs" type="number"></arg></mutation><value name="t9z1j85h32d2inf7cue"><shadow type="variables_get"><field name="VAR" id="(`^!!E4s||O8q4GJC]=~">myImage</field></shadow><block type="argument_reporter_custom" id="/S?6.uj8t(A7#7rBN9(^"><mutation typename="Image"></mutation><field name="VALUE">spriteImage</field></block></value><value name="4ss0q2by2ey6ivx4nzgfp"><shadow type="math_number"><field name="NUM">1</field></shadow><block type="argument_reporter_number" id="Jw{b7ZxhUe|ee.igJPXi"><field name="VALUE">spriteKind</field></block></value><value name="jvda6afl77fdajkbjx2mk"><shadow type="math_number"><field name="NUM">1</field></shadow><block type="typescript_expression" id="$KV-MT(?rSMf}^0MT4*S" editable="false"><field name="EXPRESSION">targetLocation.col</field></block></value><value name="mqy7ud6p56gv15piemcs"><shadow type="math_number"><field name="NUM">1</field></shadow><block type="tiles.Location_blockCombine_get" id="ji9n*wQR}5pk5}rqG?6:"><field name="property">tiles.Location.row</field><value name="location"><block type="variables_get" id="9b]!alUQ44|}8I#RW.8|"><field name="VAR" id="3{I?dy@1-T|e2cS:1$@%">targetLocation</field></block></value></block></value></block></value></block></next></block></next></block></statement></block><block type="function_definition" id="tH3zNTu^K4l.TYePeq%3" x="2942" y="20"><mutation name="createAndPlaceSprite" functionid="L`JA0;.A;#,Int4g7u*h"><arg name="img" id="t9z1j85h32d2inf7cue" type="Image"></arg><arg name="spriteKind" id="4ss0q2by2ey6ivx4nzgfp" type="number"></arg><arg name="col" id="jvda6afl77fdajkbjx2mk" type="number"></arg><arg name="row" id="mqy7ud6p56gv15piemcs" type="number"></arg></mutation><field name="function_name">createAndPlaceSprite</field><value name="t9z1j85h32d2inf7cue"><shadow type="argument_reporter_custom" id="33F*@$ZQZO{drIZYx0)G"><mutation typename="Image"></mutation><field name="VALUE">img</field></shadow></value><value name="4ss0q2by2ey6ivx4nzgfp"><shadow type="argument_reporter_number" id="Gxx61PAy9WBl.sr,Myt="><field name="VALUE">spriteKind</field></shadow></value><value name="jvda6afl77fdajkbjx2mk"><shadow type="argument_reporter_number" id=":hJv@~tnSB4G#kM$uvV2"><field name="VALUE">col</field></shadow></value><value name="mqy7ud6p56gv15piemcs"><shadow type="argument_reporter_number" id="}Yu.H]a~+mgz#6xWfact"><field name="VALUE">row</field></shadow></value><statement name="STACK"><block type="variables_set" id="qPVT54)X@wM;|c~VF9Ua"><field name="VAR" id="y-gBX=Xz9TWYE]eS3s5Q">ret</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="spritescreate" id="F0V7v1l#R~k2N%NME+3Q"><value name="img"><shadow type="screen_image_picker"></shadow><block type="argument_reporter_custom" id="8X3GC$fb4k;_1OiY|.sx"><mutation typename="Image"></mutation><field name="VALUE">img</field></block></value><value name="kind"><shadow type="spritekind"></shadow><block type="argument_reporter_number" id="r?ya2nbIfwSADh+E]u;/"><field name="VALUE">spriteKind</field></block></value></block></value><next><block type="lists_index_set" id="c)LiHk)5/}6C_^Gh*I#:"><value name="LIST"><block type="variables_get" id="*x;1k_KKIfbgg]%xzmBS"><field name="VAR" id="H(RjK*qag5i|PIJ$o/xV">aliveSprites</field></block></value><value name="INDEX"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="typescript_expression" id="P6/3;Y.yLr@6m2OacMlM" editable="false"><field name="EXPRESSION">ret.id</field></block></value><value name="VALUE"><block type="variables_get" id="E?2)w@xu}k/)Y_#2xcQf"><field name="VAR" id="y-gBX=Xz9TWYE]eS3s5Q">ret</field></block></value><next><block type="typescript_statement" id=".^k;l`:OpSP^tp~dc1S2" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="ret.onDestroyed(()=&gt; {" line1="        aliveSprites[ret.id] = null" line2="    })" numlines="3"></mutation><next><block type="mapplaceontile" id="JBZ#|pw~.3~W,Zxp#/QP"><value name="sprite"><shadow type="variables_get" id="?Qt3:?{rPi_nC_5w-n%r"><field name="VAR" id="y-gBX=Xz9TWYE]eS3s5Q">ret</field></shadow></value><value name="loc"><shadow type="mapgettile" id="Lc.$OjlHSo%T:RP~0}bB"><value name="col"><block type="argument_reporter_number" id="E8LV^[E*?y1tWr~HHL(g"><field name="VALUE">col</field></block></value><value name="row"><block type="argument_reporter_number" id="/?Bo$azcuH48hWA8L+;0"><field name="VALUE">row</field></block></value></shadow></value><next><block type="lists_index_set" id="Z569+DqEZi?ha8;-)_4C"><value name="LIST"><block type="variables_get" id="%FZQ/V-O)jK=b4+87U`("><field name="VAR" id="l@9$;fKjK#$.Iiy`DWSd">currentLocationData</field></block></value><value name="INDEX"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="math_arithmetic" id="~a7wbYj4s$+w8b;3Hqqd"><field name="OP">ADD</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="argument_reporter_number" id="]p0OjUK|AqxFd!:$My)_"><field name="VALUE">col</field></block></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="math_arithmetic" id="4s)s]}#,E`OX67rC:]]#"><field name="OP">MULTIPLY</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="argument_reporter_number" id="Q{*:68N{2T+ASyyj{s#0"><field name="VALUE">row</field></block></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="typescript_expression" id="1GzUf.O+EL1zoI5SYU.j" editable="false"><field name="EXPRESSION">game.currentScene().tileMap.data.width</field></block></value></block></value></block></value><value name="VALUE"><block type="typescript_expression" id="$i,}syh96;7BoiMm?0n5" editable="false"><field name="EXPRESSION">ret.id</field></block></value><next><block type="function_return" id="WY4P0ESh^_m_gwdPUC0|"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="k;2oe7O?Cdv0LI@LS@@d"><field name="VAR" id="y-gBX=Xz9TWYE]eS3s5Q">ret</field></block></value></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type="function_definition" id="QnPn]Zd;#+Z5kCt9|F)q" x="4192" y="20"><mutation name="getSpriteOnLoc" functionid="=qA|CedY:S{/[JJe@uUM"><arg name="col" id="n07w2lt1emrat32jc90xci" type="number"></arg><arg name="row" id="0m9puscse353dqaoceyt" type="number"></arg></mutation><field name="function_name">getSpriteOnLoc</field><value name="n07w2lt1emrat32jc90xci"><shadow type="argument_reporter_number" id="ovBRZ.zL:4{8Vx7a,BSG"><field name="VALUE">col</field></shadow></value><value name="0m9puscse353dqaoceyt"><shadow type="argument_reporter_number" id=";?u;ZM6f6WRd0~U|R;_V"><field name="VALUE">row</field></shadow></value><statement name="STACK"><block type="variables_set" id="c/l-E[8?dB*iSFNS^xTd"><field name="VAR" id="wC./_sqm1XgCyFj?BzgG">spriteId</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="lists_index_get" id="C18P.!^H$218ZD:G7O;e"><value name="LIST"><block type="variables_get" id="R|vuaj7Ww;=]mhDH@5(}"><field name="VAR" id="l@9$;fKjK#$.Iiy`DWSd">currentLocationData</field></block></value><value name="INDEX"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="math_arithmetic" id="cK*~srMNtB7avJ:rAVV,"><field name="OP">ADD</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="argument_reporter_number" id="uv7w.2RwvsBv^-n=aEwC"><field name="VALUE">col</field></block></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="math_arithmetic" id="wMh-K~o7C5{ezlucg2xr"><field name="OP">MULTIPLY</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="argument_reporter_number" id="{GVoEm|S+q@!89lTvB+g"><field name="VALUE">row</field></block></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="typescript_expression" id="n8h`%g}ElMl{hlj2Y/*+" editable="false"><field name="EXPRESSION">game.currentScene().tileMap.data.width</field></block></value></block></value></block></value></block></value><next><block type="controls_if" id="43_OETgJdCKY91F}}f?$"><mutation else="1"></mutation><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_negate" id="UvQuz|_9xk!M^i5_v8^a"><value name="BOOL"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="variables_get" id="[:K],mG^SfJ2=TMDA70f"><field name="VAR" id="wC./_sqm1XgCyFj?BzgG">spriteId</field></block></value></block></value><statement name="DO0"><block type="function_return" id="bjb`buB$on^#{8k.`jIV"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="typescript_expression" id="[1^O=pf-Ae(vNO.u1C:t" editable="false"><field name="EXPRESSION">null</field></block></value></block></statement><statement name="ELSE"><block type="function_return" id="))Xg5qif#;=]yoW.^t`t"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="lists_index_get" id="u8$nJtFtj)ddPvwOc7~b"><value name="LIST"><block type="variables_get" id="AKF2h4F~!,p^v~X7hBK["><field name="VAR" id="H(RjK*qag5i|PIJ$o/xV">aliveSprites</field></block></value><value name="INDEX"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="6n(+`Ax+KHnKYIbkN|}("><field name="VAR" id="wC./_sqm1XgCyFj?BzgG">spriteId</field></block></value></block></value></block></statement></block></next></block></statement></block><block type="function_definition" id="iNw2tgDI47?oE7=Od^wW" x="20" y="983"><mutation name="updateCursorLocation" functionid="KZ4$nTdyXHZ2Ct!R{Bj6"></mutation><field name="function_name">updateCursorLocation</field><statement name="STACK"><block type="mapplaceontile" id="/~gCl,2lkSDc0t}bvn_1"><value name="sprite"><shadow type="variables_get" id="d=_mH8t1Pi+03U6nj][;"><field name="VAR" id="dvfky@^nl)M[VDEjFl/q">cursorSprite</field></shadow></value><value name="loc"><shadow type="mapgettile" id="pTDrZJey(jq^/75pPDLh"><value name="col"><block type="lists_index_get" id="8NEQCOz7bbGEO6ycd^)d"><value name="LIST"><block type="variables_get" id="%4op:yUsRH,[Ax._BFr4"><field name="VAR" id="nElHPXdq7;P.Kg%gnA~Q">cursorLocation</field></block></value><value name="INDEX"><shadow type="math_number" id="d)g8?ZfrhZMlG;AtiH2["><field name="NUM">0</field></shadow></value></block></value><value name="row"><block type="lists_index_get" id="t58P*35SnrG|uTF:~}Rc"><value name="LIST"><block type="variables_get" id="0TLleMkXjkuL%UoKwXVT"><field name="VAR" id="nElHPXdq7;P.Kg%gnA~Q">cursorLocation</field></block></value><value name="INDEX"><shadow type="math_number" id="4(@Qv}8)YH)malp|~uKb"><field name="NUM">1</field></shadow></value></block></value></shadow></value></block></statement></block><block type="function_definition" id="!#;Jy~Nsi/fYrfkH@eM#" x="1383" y="983"><mutation name="destroyCurrentMoveDestinationShaders" functionid="{8jJGGv.U:65mUdBH[yC"></mutation><field name="function_name">destroyCurrentMoveDestinationShaders</field><statement name="STACK"><block type="pxt_controls_for_of" id="c6:k^=,ChqA]qi/j2+C7"><value name="LIST"><block type="variables_get" id="wS6)s=CybOGTQKy#am/r"><field name="VAR" id="*S8+d$R~=IglB`vhy;6d">currentMoveDestinationShaders</field></block></value><value name="VAR"><shadow type="variables_get_reporter" id=";53zkhzP,S2eB-8c:mX5"><field name="VAR" id=")Y07WePA:sx(]m!ey%8y">shader</field></shadow></value><statement name="DO"><block type="spritedestroy" id="}2XG960j_0*OGi$xh#wR"><mutation xmlns="http://www.w3.org/1999/xhtml" _expanded="0" _input_init="false"></mutation><value name="sprite"><block type="variables_get" id="jSYVV;r_d.[$!I)XF(EU"><field name="VAR" id=")Y07WePA:sx(]m!ey%8y">shader</field></block></value></block></statement></block></statement></block><block type="function_definition" id="6MU]^?peU|n}).uI9Yh+" x="2232" y="983"><mutation name="showMoveRange" functionid="82i$5zlW3^:/-*mTL:)-"><arg name="character" id="e0u35pj39sd08p0n4rur" type="Sprite"></arg></mutation><field name="function_name">showMoveRange</field><value name="e0u35pj39sd08p0n4rur"><shadow type="argument_reporter_custom" id="M*D~QFUJb]X7[`l9.kkp"><mutation typename="Sprite"></mutation><field name="VALUE">character</field></shadow></value><statement name="STACK"><block type="variables_set" id="B4Y@RD0dPdV||~ZAQL~N"><field name="VAR" id="r+NrJ2q^#oXq3m(TzkH9">currentLoc</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="function_call_output" id="YE56^Fg~N3.%,62|1Ch2"><mutation name="getSpriteLocation" functionid="%zG`%k*SZ8vSl%bT/TaI"><arg name="sprite" id="rbads6hlvipexvnvsx6fo" type="Sprite"></arg></mutation><value name="rbads6hlvipexvnvsx6fo"><shadow type="variables_get"><field name="VAR" id=";x$8kRIPQ9BEY(C~$Y2w">mySprite</field></shadow><block type="argument_reporter_custom" id="J3.+5j{JWshe10|:*{9*"><mutation typename="Sprite"></mutation><field name="VALUE">character</field></block></value></block></value><next><block type="variables_set" id="pO[n^q@ItS6C^afr6D!n"><field name="VAR" id="6v@RAuHnu@oQ7/Exe[*|">range</field><comment pinned="false" h="80" w="160">当前不管怎么样先设定可以移动3格</comment><value name="VALUE"><shadow type="math_number" id="H%|sxTufjQ3@)OC)vUka"><field name="NUM">3</field></shadow></value><next><block type="variables_set" id="c6]PmsZMq%D2:`Z|-Nl4"><field name="VAR" id="OTJOOz=WV*6Hx`():EJY">minRow</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="math_op2" id="%Qm5YUgHGy%i2hun0kO!"><field name="op">max</field><value name="x"><shadow type="math_number" id="r^3PNUbCp/(uT/2Q9=(!"><field name="NUM">0</field></shadow></value><value name="y"><block type="math_arithmetic" id="7N%8{UC73v3Xl[Ai8p?t"><field name="OP">MINUS</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="tiles.Location_blockCombine_get" id="CzMe=F2)=@G_]o/SZI/q"><field name="property">tiles.Location.row</field><value name="location"><block type="variables_get" id="BIIDQBP]vTdl8Z_C20W]"><field name="VAR" id="r+NrJ2q^#oXq3m(TzkH9">currentLoc</field></block></value></block></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="s+,Zc1sqA=XUQ#]D;.3c"><field name="VAR" id="6v@RAuHnu@oQ7/Exe[*|">range</field></block></value></block></value></block></value><next><block type="variables_set" id="EYMqKl`{{NXg8~WAWZ+!"><field name="VAR" id="[l0A/k(I4|n^U5Yh}!!]">maxRow</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="math_op2" id="sE?him6JXkqeoj);/k0z"><field name="op">min</field><value name="x"><block type="math_arithmetic" id="(lHM@I_mWsaaOHSd5[7-"><field name="OP">MINUS</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="typescript_expression" id="VQ(mmsGw`}UfJckb5H6~" editable="false"><field name="EXPRESSION">game.currentScene().tileMap.data.height</field></block></value><value name="B"><shadow type="math_number" id="6Fs::86H.ZI)zQhiwfXp"><field name="NUM">1</field></shadow></value></block></value><value name="y"><block type="math_arithmetic" id="+I5)$@Yra8%Tk)x2(oYq"><field name="OP">ADD</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="tiles.Location_blockCombine_get" id="`nuLV4M5Z|AgZAE;t}#}"><field name="property">tiles.Location.row</field><value name="location"><block type="variables_get" id="!h/7SQ`js^_hh/-c$8M|"><field name="VAR" id="r+NrJ2q^#oXq3m(TzkH9">currentLoc</field></block></value></block></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="aS=rJ[[i)is#Q`.NYO3~"><field name="VAR" id="6v@RAuHnu@oQ7/Exe[*|">range</field></block></value></block></value></block></value><next><block type="typescript_statement" id="F|eN_dB~Agx(IO8nyhQ{" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="for (let i = minRow; i &lt;= maxRow; i++) {" line1="        let step = range - Math.abs(i - currentLoc.row)" line2="        let minCol = Math.max(0, currentLoc.col - step)" line3="        let maxCol = Math.min(game.currentScene().tileMap.data.width - 1, currentLoc.col + step)" line4="        for (let j = minCol; j &lt;= maxCol; j++) {" line5="            if (getSpriteOnLoc(j, i) == null) {" line6="                let location = tiles.getTileLocation(j, i)" line7="                operation_context.addLocationCandidate(location)" line8="                let reachableTileMarker = shader.createRectangularShaderSprite(16, 16, shader.ShadeLevel.One)" line9="                tiles.placeOnTile(reachableTileMarker, location)" line10="                currentMoveDestinationShaders.push(reachableTileMarker)" line11="            }            " line12="        }" line13="    }" numlines="14"></mutation></block></next></block></next></block></next></block></next></block></statement></block><block type="function_definition" id="OVUSB%nkV81PP![c`3PX" x="3560" y="983"><mutation name="stopSelectionCursorMode" functionid="W#;*I]rLWzo=APh:Lb[A"></mutation><field name="function_name">stopSelectionCursorMode</field><statement name="STACK"><block type="typescript_statement" id="raG_d~NmSFk8c(b$!1~g" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="controller.up.onEvent(ControllerButtonEvent.Pressed, () =&gt; {" line1="    })" numlines="2"></mutation><next><block type="typescript_statement" id="kN2hqDSB|EVKebIx%mrb" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="controller.down.onEvent(ControllerButtonEvent.Pressed, () =&gt; {" line1="    })" numlines="2"></mutation><next><block type="typescript_statement" id=".z={wD/|wg?$m]Zh]A]*" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="controller.left.onEvent(ControllerButtonEvent.Pressed, () =&gt; {" line1="    })" numlines="2"></mutation><next><block type="typescript_statement" id="dz`u{SWT3Qc5afNLmcKe" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="controller.right.onEvent(ControllerButtonEvent.Pressed, () =&gt; {" line1="    })" numlines="2"></mutation><next><block type="typescript_statement" id="+YiRi8A@kuYUWguEq3a^" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="controller.A.onEvent(ControllerButtonEvent.Pressed, () =&gt; {" line1="    })" numlines="2"></mutation></block></next></block></next></block></next></block></next></block></statement></block><block type="function_definition" id="u6Npd9SuED@=|:X4S^+E" x="4242" y="983"><mutation name="applySelectionCursorMode" functionid="0Gmc)L+.4LKt3PIAiFTX"></mutation><field name="function_name">applySelectionCursorMode</field><comment pinned="false" h="80" w="160">设置当前的操作模式为光标选择单位模式</comment><statement name="STACK"><block type="typescript_statement" id="c,C1/?f/28g2I4xf23m(" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="controller.up.onEvent(ControllerButtonEvent.Pressed, () =&gt; {" line1="        if (cursorLocation[1] &gt; 1) {" line2="            cursorLocation[1] -= 1" line3="        }" line4="        updateCursorLocation()" line5="    })" numlines="6"></mutation><next><block type="typescript_statement" id="x#_4f5KvTx91OW9(B96y" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="controller.down.onEvent(ControllerButtonEvent.Pressed, () =&gt; {" line1="        if (cursorLocation[1] &lt; game.currentScene().tileMap.data.height - 1) {" line2="            cursorLocation[1] += 1" line3="        }" line4="        updateCursorLocation()" line5="    })" numlines="6"></mutation><next><block type="typescript_statement" id="S.+R.)Jn,1eTSC_vvmR(" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="controller.left.onEvent(ControllerButtonEvent.Pressed, () =&gt; {" line1="        if (cursorLocation[0] &gt; 0) {" line2="            cursorLocation[0] -= 1" line3="        }" line4="        updateCursorLocation()" line5="    })" numlines="6"></mutation><next><block type="typescript_statement" id="7^B)m=:mxG1_te6A8F|(" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="controller.right.onEvent(ControllerButtonEvent.Pressed, () =&gt; {" line1="        if (cursorLocation[0] &lt; game.currentScene().tileMap.data.width - 1) {" line2="            cursorLocation[0] += 1" line3="        }" line4="        updateCursorLocation()" line5="    })" numlines="6"></mutation><next><block type="typescript_statement" id="r=9]3I6u4p2;X#rjL)}." editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="controller.A.onEvent(ControllerButtonEvent.Pressed, ()=&gt; {" line1="        stopSelectionCursorMode()" line2="        let sprite = getSpriteOnLoc(cursorLocation[0], cursorLocation[1])" line3="        if (sprite) {" line4="            if (sprite.kind() == SpriteKind.Player) {" line5="                story.startCutscene( () =&gt; {" line6="                    story.showPlayerChoices(&quot;移动&quot;, &quot;攻击&quot;, &quot;待命&quot;)" line7="                    let choice = story.getLastAnswer()" line8="                    if(choice == &quot;移动&quot;) {" line9="                        operation_context.clearContext()" line10="                        applySelectMoveDestinationMode()" line11="                        showMoveRange(playerSprite)" line12="                        story.cancelAllCutscenes()" line13="                    }" line14="                })" line15="            }   " line16="        }" line17="    })" numlines="18"></mutation></block></next></block></next></block></next></block></next></block></statement></block><block type="function_definition" id="(Ox[ugHN@[ogcmZMKV8@" x="20" y="2853"><mutation name="applySelectMoveDestinationMode" functionid="7P_$pG(mM,i[E^bm!Sn#"></mutation><field name="function_name">applySelectMoveDestinationMode</field><statement name="STACK"><block type="typescript_statement" id="OOu+c4_ol=XGkXAq,6zI" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="controller.up.onEvent(ControllerButtonEvent.Pressed, () =&gt; {" line1="        if (cursorLocation[1] &gt; 1) {" line2="            cursorLocation[1] -= 1" line3="        }" line4="        updateCursorLocation()" line5="    })" numlines="6"></mutation><next><block type="typescript_statement" id="3GXFZ34./@6GbtJ@ij)K" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="controller.down.onEvent(ControllerButtonEvent.Pressed, () =&gt; {" line1="        if (cursorLocation[1] &lt; game.currentScene().tileMap.data.height - 1) {" line2="            cursorLocation[1] += 1" line3="        }" line4="        updateCursorLocation()" line5="    })" numlines="6"></mutation><next><block type="typescript_statement" id="Q{_MWP[XVw?:(V,932SO" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="controller.left.onEvent(ControllerButtonEvent.Pressed, () =&gt; {" line1="        if (cursorLocation[0] &gt; 0) {" line2="            cursorLocation[0] -= 1" line3="        }" line4="        updateCursorLocation()" line5="    })" numlines="6"></mutation><next><block type="typescript_statement" id="QELHLRkfO:y6D_.XRHwF" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="controller.right.onEvent(ControllerButtonEvent.Pressed, () =&gt; {" line1="        if (cursorLocation[0] &lt; game.currentScene().tileMap.data.width - 1) {" line2="            cursorLocation[0] += 1" line3="        }" line4="        updateCursorLocation()" line5="    })" numlines="6"></mutation><next><block type="typescript_statement" id="[]EzJx0FoxS/e#oUI4[]" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="controller.A.onEvent(ControllerButtonEvent.Pressed, () =&gt; {" line1="        let cursorLocation2 = getSpriteLocation(cursorSprite)" line2="        if (!operation_context.validLocation(cursorLocation2)) {" line3="            return" line4="        }" line5="" line6="        story.startCutscene(() =&gt; {" line7="            destroyCurrentMoveDestinationShaders()" line8="            moveSprite(playerSprite, getSpriteLocation(playerSprite), tiles.locationOfSprite(cursorSprite))" line9="            story.spriteMoveToLocation(playerSprite, cursorSprite.x, cursorSprite.y, 100)" line10="            applySelectionCursorMode()" line11="            story.cancelAllCutscenes()" line12="        }) " line13="    })" numlines="14"></mutation></block></next></block></next></block></next></block></next></block></statement></block></xml>